pkgname=xray-core
version=25.9.11
revision=1
short_desc="A platform for building proxies to bypass network restrictions"
maintainer="RohamN0 <roham@rohamnodoust.ir>"
license="MPL-2.0"
homepage="https://github.com/XTLS/Xray-core"
distfiles="https://github.com/XTLS/Xray-core/releases/download/v${version}/Xray-linux-64.zip"
checksum="e3e26d15b0306401a6ec80e46bf165669c0fc2ac32626f19ad35071bd721115c"

hostmakedepends="unzip"
noextract="Xray-linux-64.zip"

do_extract() {
    mkdir -p ${wrksrc}
    unzip ${XBPS_SRCDISTDIR}/${pkgname}-${version}/Xray-linux-64.zip -d ${wrksrc}
}

do_install() {
    install -Dm755 ${wrksrc}/xray ${DESTDIR}/usr/bin/xray
    install -Dm644 ${wrksrc}/geoip.dat ${DESTDIR}/usr/share/xray/geoip.dat
    install -Dm644 ${wrksrc}/geosite.dat ${DESTDIR}/usr/share/xray/geosite.dat
}

post_install() {
    vlicense LICENSE
}
